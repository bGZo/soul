description:: A Python library for pulling data out of HTML and XML files
icon:: 🐍
tags:: #[[Python Library]]
created:: [[20230627]]

- ## Why
- ## How
- ## What
  - [beautifulsoup4 · PyPI](https://pypi.org/project/beautifulsoup4/)
  - [Beautiful Soup 4.4.0 文档 — Beautiful Soup 4.2.0 documentation (crummy.com)](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/)
    collapsed:: true
    - [寻求帮助](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id5)
    - [快速开始](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id8)
    - [安装 Beautiful Soup](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id9)
    - [安装完成后的问题](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id12)
      - [安装解析器](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id13)
    - [如何使用](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id14)
    - [对象的种类](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id15)
    - [Tag](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#tag)
    - [Name](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#name)
      - [Attributes](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#attributes)
    - [多值属性](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id16)
    - [可以遍历的字符串](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id17)
      - [BeautifulSoup](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#beautifulsoup)
      - [注释及特殊字符串](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id18)
    - [遍历文档树](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id19)
    - [子节点](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id20)
    - [tag的名字](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id21)
      - [.contents 和 .children](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#contents-children)
      - [.descendants](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#descendants)
      - [.string](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#string)
      - [.strings 和 stripped_strings](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#strings-stripped-strings)
    - [父节点](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id24)
    - [.parent](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#parent)
      - [.parents](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#parents)
    - [兄弟节点](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id25)
    - [.next_sibling 和 .previous_sibling](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#next-sibling-previous-sibling)
      - [.next_siblings 和 .previous_siblings](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#next-siblings-previous-siblings)
    - [回退和前进](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id26)
    - [.next_element 和 .previous_element](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#next-element-previous-element)
      - [.next_elements 和 .previous_elements](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#next-elements-previous-elements)
    - [搜索文档树](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id28)
    - [过滤器](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id29)
    - [字符串](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id31)
      - [正则表达式](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id32)
      - [列表](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id33)
      - [True](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#true)
      - [方法](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id34)
    - [find_all()](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#find-all)
    - [name 参数](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id36)
      - [keyword 参数](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#keyword)
      - [按CSS搜索](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#css)
      - [string 参数](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id37)
      - [limit 参数](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#limit)
      - [recursive 参数](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#recursive)
    - [像调用 find_all() 一样调用tag](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#find-all-tag)
      - [find()](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#find)
      - [find_parents() 和 find_parent()](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#find-parents-find-parent)
      - [find_next_siblings() 和 find_next_sibling()](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#find-next-siblings-find-next-sibling)
      - [find_previous_siblings() 和 find_previous_sibling()](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#find-previous-siblings-find-previous-sibling)
      - [find_all_next() 和 find_next()](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#find-all-next-find-next)
      - [find_all_previous() 和 find_previous()](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#find-all-previous-find-previous)
      - [CSS选择器](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id42)
    - [修改文档树](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id45)
    - [修改tag的名称和属性](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id46)
      - [修改 .string](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id47)
      - [append()](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#append)
      - [NavigableString() 和 .new_tag()](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#navigablestring-new-tag)
      - [insert()](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#insert)
      - [insert_before() 和 insert_after()](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#insert-before-insert-after)
      - [clear()](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#clear)
      - [extract()](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#extract)
      - [decompose()](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#decompose)
      - [replace_with()](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#replace-with)
      - [wrap()](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#wrap)
      - [unwrap()](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#unwrap)
    - [输出](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id49)
    - [格式化输出](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id50)
      - [压缩输出](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id51)
      - [输出格式](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id52)
      - [get_text()](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#get-text)
    - [指定文档解析器](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id53)
    - [解析器之间的区别](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id54)
    - [编码](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id56)
    - [输出编码](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id58)
      - [Unicode, Dammit! (乱码, 靠!)](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#unicode-dammit)
    - [智能引号](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id59)
      - [矛盾的编码](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id61)
    - [比较对象是否相同](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id63)
    - [复制Beautiful Soup对象](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id64)
    - [解析部分文档](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id65)
    - [SoupStrainer](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#soupstrainer)
    - [常见问题](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id66)
    - [代码诊断](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id67)
      - [文档解析错误](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id68)
      - [版本错误](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id69)
      - [解析成XML](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#xml)
      - [解析器的错误](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id70)
      - [杂项错误](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id72)
      - [如何提高效率](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id73)
    - [Beautiful Soup 3](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#beautiful-soup-3)
    - [迁移到BS4](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id76)
    - [需要的解析器](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id77)
      - [方法名的变化](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id78)
      - [生成器](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id79)
      - [XML](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id80)
      - [实体](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id81)
      - [迁移杂项](https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/#id82)
  - [Beautiful Soup Documentation — Beautiful Soup 4.12.0 documentation (crummy.com)](https://www.crummy.com/software/BeautifulSoup/bs4/doc/)
    - > This document covers Beautiful Soup version 4.12.1. The examples in this documentation were written for Python 3.8.
    - Installing
      collapsed:: true
      - ```
        $ apt-get install Python-bs4
        $ easy_install beautifulsoup4
        $ pip install beautifulsoup4
        ```
    - Parser
      - ```python
        BeautifulSoup(markup, "html.parser")
        BeautifulSoup(markup, "lxml") # "xml" / "lxml-xml"
        BeautifulSoup(markup, "html5lib")
        ```
        - [lxml parser](http://lxml.de/)
        - [html5lib parser](http://code.google.com/p/html5lib/)
      - [Differences between parsers](https://www.crummy.com/software/BeautifulSoup/bs4/doc/#differences-between-parsers)
    - Kinds of objects
      collapsed:: true
      - `Tag`: corresponds(相同) to an XML or HTML tag in the original document.
      - `NavigableString`: contain a bit of text within a tag.
        collapsed:: true
        - #+BEGIN_NOTE
          NavigableString supports most of the features described in Navigating the tree and Searching the tree, but not all of them. In particular, since a string can’t contain anything (the way a tag may contain a string or another tag), strings don’t support the .contents or .string attributes, or the find() method.
          If you want to use a NavigableString outside of Beautiful Soup, you should call unicode() on it to turn it into a normal Python Unicode string. If you don’t, your string will carry around a reference to the entire Beautiful Soup parse tree, even when you’re done using Beautiful Soup. This is a big waste of memory.
          #+END_NOTE
      - `BeautifulSoup`:  represents the parsed document as a whole.
      - `Comment`:  a special type of `NavigableString`
    - Navigating the tree（遍历文档树）
      collapsed:: true
      - Going down
        - `.contents` and `.children`
        - `.descendants`（后代）
          - ```python
            for child in head_tag.descendants:
                print(child)
            # <title>The Dormouse's story</title>
            # The Dormouse's story
            ```
            - The <head> tag has only one child, but it has two descendants: the <title> tag and the <title> tag’s child.
        - .`strings` and `stripped_strings`
          - The <head> tag has only one child, but it has two descendants: the <title> tag and the <title> tag’s child.
      - Going up
        - `.parent`
        - `.parents`
      - Going sideways
        - `.next_sibling` and `.previous_sibling`
        - `.next_siblings` and `.previous_siblings`
      - Going back and forth
        - `.next_element` 和 `.previous_element`
    - Searching the tree
      - Kinds of filters 
        - String `soup.find_all('b')`
        - Regular expression `soup.find_all(re.compile("^b"))`
        - List `soup.find_all(["a", "b"])`
        - True `soup.find_all(True)`
        - Function
          collapsed:: true
          - ```python
            def has_class_but_no_id(tag):
                return tag.has_attr('class') and not tag.has_attr('id')
            soup.find_all(has_class_but_no_id)
            ```
      - `find_all(name, attrs, recursive, string, limit, **kwargs)`
        -
-
- ## Notes
  - #+BEGIN_NOTE
    Self-closing tags, like `<br/>`, `<img/>`, have a redundant block under `html.parser`!
    #+END_NOTE
    - ```python
      from bs4 import BeautifulSoup
      html_doc='''
      <a class="work_thumb_box" data-vue-component="thumb-img-popup">
        <img/>
        <br/>
        <div class="work_img_popover" v-cloak="">
          <img/>
        </div>
      </a>
      '''
      soup = BeautifulSoup(html_doc, 'html.parser')
      print(soup.a.img.next_sibling) #2
      print(soup.a.img.next_sibling
            			.next_sibling.next_sibling) # 2
      print(soup.a.img.next_sibling
            			.next_sibling.next_sibling
            			.next_sibling.img.next_sibling) # 2
      ```
    - 如上代码，在原生的扫描器下，打印了三个自闭和标签的下一个兄弟，得到的是 6 个换行符，然后回显显示7行。
-